---
branches:
  only:
    - master

sudo: required

language: python

python: 3.9

cache:
  pip: true
  directories:
    - molecule/.nexus-downloads/

services:
  - docker

install:
  - pip install --upgrade --upgrade-strategy eager -r requirements.txt

env:
  - SCENARIO=default
  - SCENARIO=default-centos7
  - SCENARIO=default-debian_bullseye

script: |
  if [ "${SCENARIO}" == "default" ]; then
    ./tests/test_groovySyntax.sh
    molecule test
  else
    molecule test -s "${SCENARIO}"
  fi

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
